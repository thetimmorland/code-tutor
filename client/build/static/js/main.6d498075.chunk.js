(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{557:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(13),o=n.n(c),l=(n(93),n(40)),i=n(6),u=n(587),s=n(38),d=n(16),m=n(75),f=n(76),p=n.n(f),h=new m.a(("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+"/websocket"),b=new p.a.Connection(h),E=Object(a.createContext)(null);function v(){return Object(a.useContext)(E)}function g(e){var t=e.children,n=Object(i.g)().id,c=Object(a.useState)(),o=Object(d.a)(c,2),l=o[0],u=o[1],m=Object(a.useRef)(null);Object(a.useEffect)((function(){return m.current=b.get("collection",n),m.current.subscribe((function(e){if(e)throw e;u(Object(s.a)({},m.current.data)),m.current.on("op",(function(){u(Object(s.a)({},m.current.data))}))})),function(){m.current.destroy()}}),[n]);return m.current&&!m.current.type?r.a.createElement(i.a,{to:"/"}):m.current&&r.a.createElement(E.Provider,{value:{value:l,submitOp:function(e){console.log(e),m.current.submitOp(e)}}},t)}var w=n(588),j=n(580),O=n(578),x=n(78),y=n.n(x),C=Object(O.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function S(){var e=C(),t=Object(a.useState)(),n=Object(d.a)(t,2),c=n[0],o=n[1];return Object(a.useEffect)((function(){y.a.get("/api/createSketch").then((function(e){o(e.data)}))}),[]),c?r.a.createElement(i.a,{to:c}):r.a.createElement(w.a,{className:e.backdrop,open:!0},r.a.createElement(j.a,{color:"inherit"}))}var k=n(43),N=n(582),L=n(583),M=n(584),G=n(558),H=n(585),T=n(586),B='\n  window.onerror = function (text, url, row, column, error) {\n    const payload = row + ":" + column + " " + text;\n    window.parent.postMessage({ source: "code-tutor-bridge", payload}, \'*\');\n    return true;\n  };\n\n  var console = {\n    log: function () {\n      let payload = "";\n\n      for(idx = 0; idx < arguments.length; idx++) {\n        payload += arguments[idx];\n      };\n\n      window.parent.postMessage({ source: "code-tutor-bridge", payload }, \'*\');\n    }\n  };\n  '.replace(/\n/g,"");function z(e){var t=e.value,n=e.setLog;Object(a.useEffect)((function(){function e(e){if("code-tutor-bridge"===e.data.source){var t=e.data.payload;"string"===typeof t&&n((function(e){return[].concat(Object(k.a)(e),[t])}))}}return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[n]);var c=(new DOMParser).parseFromString("<html><head></head><body></body></html>","text/html"),o=c.createElement("style");o.type="text/css",o.innerHTML="body { margin: 0px; padding 0px; font-size: 0 }",c.head.appendChild(o);var l=c.createElement("script");l.src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.js",c.head.appendChild(l);var i=c.createElement("script");i.innerHTML=B,c.head.appendChild(i);var u=c.createElement("script");return u.innerHTML=t,c.head.appendChild(u),r.a.createElement("iframe",{title:"sketch",srcDoc:c.documentElement.outerHTML,frameBorder:0,style:{width:"100%",height:"100%"},sandbox:"allow-scripts allow-pointer-lock allow-same-origin allow-popups allow-forms allow-modals"})}var D=n(83),P=n(84),R=n.n(P);n(140),n(141),n(142);function F(){var e=v(),t=e.value,n=e.submitOp,c=(t||{}).code,o=Object(a.useRef)(null);Object(a.useEffect)((function(){o.current=c}),[t]);return r.a.createElement(R.a,{mode:"javascript",theme:"github",defaultValue:c,value:c,tabSize:2,onChange:function(e){console.log(e);var t=Object(D.diffChars)(o.current,e.replace(/\r\n/g,"\n")),a=0;t.forEach((function(e){var t=e.count,r=e.value,c=e.added,o=e.removed;c?n({p:["code",a],si:r}):o&&n({p:["code",a],sd:r}),o||(a+=t)}))},debounceChangePeriod:50,annotations:[],width:"100%",height:"100%"})}var I=n(581),J=n(589),W=n(590),V=Object(O.a)((function(e){return{list:{height:"100%",width:"100%",overflow:"auto"},text:{fontFamily:"monospace",whiteSpace:"pre-line"}}}));function $(e){var t=e.value,n=V(),c=Object(a.useState)(!0),o=Object(d.a)(c,2),l=o[0],i=o[1],u=Object(a.useRef)(null);Object(a.useEffect)((function(){u.current&&l&&(u.current.scrollTop=u.current.scrollHeight)}),[t,u,l]);return r.a.createElement(I.a,{className:n.list,ref:u,onScroll:function(e){var t=e.target;i(t.scrollTop===t.scrollHeight-t.offsetHeight)}},(t||[]).map((function(e,t){return r.a.createElement(J.a,{dense:!0,divider:!0,key:t},r.a.createElement(W.a,{primaryTypographyProps:{className:n.text},primary:e}))})))}var q=Object(O.a)((function(e){return{root:{display:"flex",height:"100vh"},main:{flexGrow:1,display:"flex"},appBarSpacer:Object(s.a)({flexGrow:0,flexShrink:0},e.mixins.toolbar),content:{flexGrow:1,display:"flex"},leftColumn:{flexGrow:.5,display:"flex",flexDirection:"column"},rightColumn:{flexGrow:.5,display:"flex",flexDirection:"column"},editorContainer:{flexGrow:.8},logContainer:{flexGrow:.2},paper:{height:"100%"}}}));function A(){var e=q(),t=((v()||{}).value||{}).code,n=Object(a.useRef)(null);Object(a.useEffect)((function(){n.current=t}),[t]);var c=Object(a.useState)(""),o=Object(d.a)(c,2),l=o[0],i=o[1],u=Object(a.useState)([]),s=Object(d.a)(u,2),m=s[0],f=s[1];return Object(a.useEffect)((function(){f(l?["Starting Sketch..."]:function(e){return[].concat(Object(k.a)(e),["Sketch Stopped."])})}),[l]),r.a.createElement("div",{className:e.root},r.a.createElement(N.a,null,r.a.createElement(L.a,{className:e.toolbar},r.a.createElement(M.a,{edge:"start",color:"inherit",onClick:function(){i(n.current)}},r.a.createElement(H.a,null)),r.a.createElement(M.a,{color:"inherit",onClick:function(){i("")}},r.a.createElement(T.a,null)))),r.a.createElement("main",{className:e.main},r.a.createElement("div",{className:e.appBarSpacer}),r.a.createElement("div",{className:e.content},r.a.createElement("div",{className:e.leftColumn},r.a.createElement("div",{className:e.editorContainer},r.a.createElement(G.a,{className:e.paper,variant:"outlined"},r.a.createElement(F,null))),r.a.createElement("div",{className:e.logContainer},r.a.createElement(G.a,{className:e.paper,variant:"outlined"},r.a.createElement($,{value:m})))),r.a.createElement("div",{className:e.rightColumn},r.a.createElement(G.a,{className:e.paper,variant:"outlined"},r.a.createElement(z,{value:l,setLog:f}))))))}function K(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null),r.a.createElement(l.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/"},r.a.createElement(S,null)),r.a.createElement(i.b,{path:"/:id"},r.a.createElement(g,null,r.a.createElement(A,null))))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},88:function(e,t,n){e.exports=n(557)},93:function(e,t,n){}},[[88,1,2]]]);
//# sourceMappingURL=main.6d498075.chunk.js.map